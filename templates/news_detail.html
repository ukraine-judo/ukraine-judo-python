{% extends "base.html" %}

{% block title %}{{ news.title }} - Федерація Дзюдо України{% endblock %}

{% block content %}
<!-- Hero Section (Immersive) -->
<div class="relative w-full h-[60vh] min-h-[500px] flex items-end">
    <div class="absolute inset-0 bg-cover bg-center bg-no-repeat" 
         style='background-image: url("{{ news.image_full_url if news.image_full_url else 'https://via.placeholder.com/1440x600/137fec/FFFFFF?text=News' }}");'>
    </div>
    
    <!-- Gradient Overlay -->
    <div class="absolute inset-0 bg-gradient-to-t from-[#111418]/95 via-[#111418]/50 to-transparent"></div>
    
    <div class="relative z-10 w-full max-w-[1280px] mx-auto px-4 md:px-10 pb-12 lg:pb-16">
        <div class="w-full">
            <!-- Category & Date -->
            <div class="flex flex-wrap items-center gap-3 mb-4">
                <span class="bg-primary text-white text-xs font-bold px-3 py-1 rounded uppercase tracking-wider">
                    {{ news.display_category if news.display_category else news.category }}
                </span>
                <span class="text-white/80 text-sm font-medium flex items-center gap-1">
                    <span class="material-symbols-outlined text-[16px]">calendar_today</span> 
                    {{ news.publishedAt }}
                </span>
                {% if news.tags_list and news.tags_list|length > 0 %}
                <span class="text-white/80 text-sm font-medium flex items-center gap-1">
                    <span class="material-symbols-outlined text-[16px]">schedule</span> 
                    5 хв читання
                </span>
                {% endif %}
            </div>
            
            <!-- Title -->
            <h1 class="text-white text-3xl md:text-4xl lg:text-5xl xl:text-6xl font-black leading-tight tracking-tight mb-4 drop-shadow-lg">
                {{ news.title }}
            </h1>
            
            <!-- Excerpt -->
            {% if news.excerpt %}
            <p class="text-gray-200 text-base md:text-lg lg:text-xl mb-6 drop-shadow-md max-w-4xl">
                {{ news.excerpt }}
            </p>
            {% endif %}
            
            <!-- Author Info -->
            {% if news.author_name %}
            <div class="flex items-center gap-2 mt-6">
                <div class="size-10 rounded-full bg-primary/20 backdrop-blur-sm flex items-center justify-center text-white font-bold border-2 border-white/20">
                    {{ news.author_name[0] if news.author_name else 'A' }}
                </div>
                <div class="text-white">
                    <p class="text-sm font-bold leading-none">{{ news.author_name }}</p>
                    <p class="text-xs text-white/70 mt-1">Автор статті</p>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<!-- Main Content Layout -->
<div class="max-w-[1280px] mx-auto px-4 md:px-10 py-12">
    <div class="grid grid-cols-1 lg:grid-cols-12 gap-10">
        <!-- Left Column: Article Content (8 cols) -->
        <article class="lg:col-span-8 flex flex-col gap-8">
            <!-- Article Body -->
            <div class="prose prose-lg prose-slate max-w-none text-[#617589]">
                {{ news.content | safe }}
            </div>
            
            <!-- Tags Section -->
            {% if news.tags_list and news.tags_list|length > 0 %}
            <div class="pt-8 border-t border-gray-200">
                <div class="flex items-center gap-2 mb-4">
                    <span class="material-symbols-outlined text-primary text-[24px]">local_offer</span>
                    <h3 class="text-lg font-bold text-[#111418]">Теги статті</h3>
                </div>
                <div class="flex flex-wrap gap-2">
                    {% for tag in news.tags_list %}
                    <span class="px-4 py-2 bg-[#f0f2f4] text-[#111418] text-sm font-medium rounded-full transition-all duration-300 hover:bg-primary hover:text-white hover:shadow-md hover:scale-105 cursor-default select-none">
                        #{{ tag }}
                    </span>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
            
            <!-- Navigation: Back & Share -->
            <div class="mt-8 pt-8 border-t border-gray-200 flex flex-col sm:flex-row items-center justify-between gap-4">
                <a href="/news" 
                   class="inline-flex items-center gap-2 px-6 py-3 rounded-lg border-2 border-gray-200 text-[#111418] font-bold text-sm hover:border-primary hover:text-primary transition-all hover:shadow-md group">
                    <span class="material-symbols-outlined text-[20px] group-hover:-translate-x-1 transition-transform">arrow_back</span>
                    Повернутись до новин
                </a>
                
                <div class="flex items-center gap-3">
                    <span class="text-sm text-[#617589] font-medium">Поділитися:</span>
                    <div class="flex gap-2">
                        <button onclick="shareOnFacebook()" 
                                class="w-10 h-10 rounded-lg bg-[#1877f2] hover:bg-[#166fe5] text-white flex items-center justify-center transition-all hover:scale-105"
                                aria-label="Поділитися в Facebook">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                            </svg>
                        </button>
                        <button onclick="shareOnTwitter()" 
                                class="w-10 h-10 rounded-lg bg-[#1da1f2] hover:bg-[#1a91da] text-white flex items-center justify-center transition-all hover:scale-105"
                                aria-label="Поділитися в Twitter">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
                            </svg>
                        </button>
                        <button onclick="shareOnTelegram()" 
                                class="w-10 h-10 rounded-lg bg-[#0088cc] hover:bg-[#0077b5] text-white flex items-center justify-center transition-all hover:scale-105"
                                aria-label="Поділитися в Telegram">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </article>

        <!-- Right Column: Sidebar (4 cols) -->
        <aside class="lg:col-span-4 space-y-6">
            <div class="sticky top-24 space-y-6">
                <!-- Latest News -->
                <div class="bg-white rounded-2xl border-2 border-gray-100 p-6 shadow-sm">
                    <h4 class="text-sm font-bold text-[#617589] uppercase tracking-wider mb-4 flex items-center gap-2">
                        <span class="material-symbols-outlined text-primary text-[20px]">schedule</span>
                        Останні новини
                    </h4>
                    
                    {% if latest_news and latest_news|length > 0 %}
                    <div class="flex flex-col gap-4">
                        {% for item in latest_news %}
                        <a href="/news/{{ item.id }}" class="group flex gap-3 items-start pb-4 border-b border-gray-100 last:border-0 last:pb-0">
                            <div class="w-16 h-16 rounded-lg bg-gray-200 bg-cover bg-center shrink-0 overflow-hidden group-hover:scale-105 transition-transform duration-300" 
                                 style='background-image: url("{{ item.image_full_url if item.image_full_url else 'https://via.placeholder.com/64x64/137fec/FFFFFF?text=News' }}");'>
                            </div>
                            <div class="flex flex-col flex-1 min-w-0">
                                <h5 class="text-sm font-bold text-[#111418] group-hover:text-primary transition-colors line-clamp-2 leading-tight mb-2">
                                    {{ item.title }}
                                </h5>
                                <div class="flex items-center gap-2 text-xs text-[#617589]">
                                    <span class="material-symbols-outlined text-[12px]">calendar_today</span>
                                    <span>{{ item.publishedAt }}</span>
                                </div>
                            </div>
                        </a>
                        {% endfor %}
                    </div>
                    {% else %}
                    <div class="text-center py-6">
                        <span class="material-symbols-outlined text-gray-300 text-[40px] block mb-2">article</span>
                        <p class="text-sm text-[#617589]">Немає новин</p>
                    </div>
                    {% endif %}
                </div>

                <!-- Related News -->
                <div class="bg-white rounded-2xl border-2 border-gray-100 p-6 shadow-sm">
                    <h4 class="text-sm font-bold text-[#617589] uppercase tracking-wider mb-4 flex items-center gap-2">
                        <span class="material-symbols-outlined text-primary text-[20px]">article</span>
                        Схожі новини
                    </h4>
                    
                    {% if related_news and related_news|length > 0 %}
                    <div class="flex flex-col gap-5">
                        {% for item in related_news %}
                        <a href="/news/{{ item.id }}" class="group flex gap-4 items-start">
                            <div class="w-20 h-20 rounded-lg bg-gray-200 bg-cover bg-center shrink-0 overflow-hidden group-hover:scale-105 transition-transform duration-300" 
                                 style='background-image: url("{{ item.image_full_url if item.image_full_url else 'https://via.placeholder.com/80x80/137fec/FFFFFF?text=News' }}");'>
                            </div>
                            <div class="flex flex-col justify-between h-full flex-1">
                                <h5 class="text-sm font-bold text-[#111418] group-hover:text-primary transition-colors line-clamp-2 leading-tight">
                                    {{ item.title }}
                                </h5>
                                <div class="flex items-center justify-between mt-2">
                                    <span class="text-xs text-[#617589] flex items-center gap-1">
                                        <span class="material-symbols-outlined text-[12px]">calendar_today</span>
                                        {{ item.publishedAt }}
                                    </span>
                                    <span class="text-xs font-bold text-primary uppercase">
                                        {{ item.display_category }}
                                    </span>
                                </div>
                            </div>
                        </a>
                        {% endfor %}
                    </div>
                    {% else %}
                    <div class="text-center py-8">
                        <span class="material-symbols-outlined text-gray-300 text-[48px] block mb-2">article</span>
                        <p class="text-sm text-[#617589]">Схожих новин не знайдено</p>
                    </div>
                    {% endif %}
                </div>

                <!-- Quick Links CTA -->
                <div class="bg-gradient-to-br from-blue-500 to-blue-700 rounded-2xl p-6 text-white relative overflow-hidden">
                    <div class="absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -mr-16 -mt-16"></div>
                    <div class="relative z-10">
                        <span class="material-symbols-outlined text-[40px] mb-3 block opacity-90">calendar_month</span>
                        <h4 class="text-lg font-black mb-2">Календар змагань</h4>
                        <p class="text-sm text-white/90 mb-4 leading-relaxed">
                            Перегляньте актуальні події та турніри
                        </p>
                        <a href="/events" 
                           class="inline-flex items-center gap-2 bg-white/20 hover:bg-white/30 backdrop-blur-sm px-4 py-2 rounded-lg text-sm font-bold transition-all hover:shadow-lg">
                            Відкрити календар
                            <span class="material-symbols-outlined text-[18px]">arrow_forward</span>
                        </a>
                    </div>
                </div>
            </div>
        </aside>
    </div>
</div>

<!-- Custom Styles for Article Content -->
<!-- Custom Styles for Article Content -->
<style>
/* Prose Styling for Article Content */
.prose {
    color: #617589;
}

/* Заголовки */
.prose h2 {
    color: #111418;
    font-size: 1.875rem;
    font-weight: 800;
    margin-top: 2.5rem;
    margin-bottom: 1.25rem;
    line-height: 1.3;
    border-left: 4px solid #0d7ff2;
    padding-left: 1rem;
}

.prose h3 {
    color: #111418;
    font-size: 1.5rem;
    font-weight: 700;
    margin-top: 2rem;
    margin-bottom: 1rem;
    line-height: 1.4;
}

.prose h4 {
    color: #111418;
    font-size: 1.25rem;
    font-weight: 600;
    margin-top: 1.5rem;
    margin-bottom: 0.75rem;
}

/* Параграфи */
.prose p {
    margin-bottom: 1.25rem;
    line-height: 1.8;
    font-size: 1.125rem;
}

.prose p:empty {
    display: none;
}

/* Span всередині параграфів */
.prose span {
    display: inline;
}

/* Strong та Bold */
.prose strong,
.prose b {
    color: #111418;
    font-weight: 700;
}

/* Посилання */
.prose a {
    color: #0d7ff2;
    text-decoration: underline;
    font-weight: 500;
    transition: all 0.2s;
}

.prose a:hover {
    color: #0b6cd0;
    text-decoration: none;
}

/* Списки */
.prose ul,
.prose ol {
    margin: 1.5rem 0;
    padding-left: 0;
    list-style: none;
}

.prose ul li,
.prose ol li {
    margin-bottom: 0.75rem;
    line-height: 1.8;
    padding-left: 2rem;
    position: relative;
}

.prose ul li:before {
    content: "•";
    color: #0d7ff2;
    font-size: 1.5rem;
    font-weight: bold;
    position: absolute;
    left: 0.5rem;
    top: -0.1rem;
}

.prose ol {
    counter-reset: item;
}

.prose ol li {
    counter-increment: item;
}

.prose ol li:before {
    content: counter(item) ".";
    color: #0d7ff2;
    font-weight: 700;
    position: absolute;
    left: 0.5rem;
}

/* Вкладені списки */
.prose ul ul,
.prose ol ol,
.prose ul ol,
.prose ol ul {
    margin: 0.5rem 0 0.5rem 1rem;
}

/* Таблиці */
.prose table {
    width: 100%;
    border-collapse: collapse;
    margin: 2rem 0;
    font-size: 0.95rem;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    border-radius: 0.5rem;
    overflow: hidden;
}

.prose table thead tr {
    background: linear-gradient(135deg, #0d7ff2 0%, #0b6cd0 100%);
    color: white;
    text-align: left;
    font-weight: 700;
}

.prose table th {
    padding: 1rem;
    font-weight: 700;
    text-transform: uppercase;
    font-size: 0.85rem;
    letter-spacing: 0.05em;
}

.prose table tbody tr {
    border-bottom: 1px solid #e5e7eb;
    transition: background-color 0.2s;
}

.prose table tbody tr:hover {
    background-color: #f9fafb;
}

.prose table tbody tr:last-child {
    border-bottom: none;
}

.prose table td {
    padding: 1rem;
    color: #617589;
    vertical-align: middle;
}

/* Перша колонка (місце) */
.prose table td:first-child {
    font-weight: 700;
    color: #111418;
    font-size: 1.1rem;
}

/* Золото, срібло, бронза кольори для місць */
.prose table tbody tr:nth-child(1) td:first-child {
    color: #FFD700;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
}

.prose table tbody tr:nth-child(2) td:first-child {
    color: #C0C0C0;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
}

.prose table tbody tr:nth-child(3) td:first-child,
.prose table tbody tr:nth-child(4) td:first-child {
    color: #CD7F32;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
}

/* Responsive таблиці */
@media (max-width: 768px) {
    .prose table {
        font-size: 0.85rem;
    }
    
    .prose table th,
    .prose table td {
        padding: 0.75rem 0.5rem;
    }
}

/* Зображення */
.prose img {
    border-radius: 1rem;
    margin: 2rem auto;
    width: 100%;
    max-width: 100%;
    height: auto;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
    display: block;
}

/* Blockquote */
.prose blockquote {
    border-left: 4px solid #0d7ff2;
    padding-left: 1.5rem;
    margin: 2rem 0;
    font-style: italic;
    color: #617589;
    background: linear-gradient(to right, #f0f2f4 0%, transparent 100%);
    padding: 1.5rem;
    border-radius: 0 0.5rem 0.5rem 0;
}

/* Code */
.prose code {
    background: #f0f2f4;
    padding: 0.2rem 0.5rem;
    border-radius: 0.375rem;
    font-size: 0.9em;
    color: #111418;
    font-family: 'Courier New', monospace;
    font-weight: 500;
}

.prose pre {
    background: #111418;
    color: #ffffff;
    padding: 1.5rem;
    border-radius: 0.75rem;
    overflow-x: auto;
    margin: 1.5rem 0;
    line-height: 1.5;
}

.prose pre code {
    background: transparent;
    padding: 0;
    color: inherit;
}

/* Horizontal Rule */
.prose hr {
    border: none;
    border-top: 2px solid #e5e7eb;
    margin: 3rem 0;
}

/* Italic та Em */
.prose em,
.prose i {
    font-style: italic;
    color: #617589;
}

/* Підкреслення */
.prose u {
    text-decoration: underline;
    text-decoration-color: #0d7ff2;
    text-decoration-thickness: 2px;
}

/* Видалений текст */
.prose del,
.prose s {
    text-decoration: line-through;
    opacity: 0.7;
}

/* Mark/Highlight */
.prose mark {
    background: linear-gradient(120deg, #fef08a 0%, #fde047 100%);
    padding: 0.1rem 0.3rem;
    border-radius: 0.25rem;
}

/* Clearfix для старих div */
.prose .clrt {
    display: none;
}

/* Видалити порожні параграфи з data атрибутами */
.prose p[data-end][data-start]:empty {
    display: none;
}

/* Адаптивність */
@media (max-width: 640px) {
    .prose {
        font-size: 1rem;
    }
    
    .prose h2 {
        font-size: 1.5rem;
    }
    
    .prose h3 {
        font-size: 1.25rem;
    }
    
    .prose p {
        font-size: 1rem;
    }
    
    .prose img {
        border-radius: 0.5rem;
        margin: 1.5rem auto;
    }
}
</style>


<script>
// Share Functions
function shareOnFacebook() {
    const url = encodeURIComponent(window.location.href);
    window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, '_blank', 'width=600,height=400');
}

function shareOnTwitter() {
    const url = encodeURIComponent(window.location.href);
    const text = encodeURIComponent('{{ news.title }}');
    window.open(`https://twitter.com/intent/tweet?url=${url}&text=${text}`, '_blank', 'width=600,height=400');
}

function shareOnTelegram() {
    const url = encodeURIComponent(window.location.href);
    const text = encodeURIComponent('{{ news.title }}');
    window.open(`https://t.me/share/url?url=${url}&text=${text}`, '_blank');
}
</script>
{% endblock %}
